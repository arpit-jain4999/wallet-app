---
alwaysApply: true
---

/**
 * Money formatting and validation utilities
 */

export function formatMoney(amount: number): string {
  // Format with up to 4 decimal places, remove trailing zeros
  return amount.toFixed(4).replace(/\.?0+$/, '');
}

export function validateAmount(amount: string): {
  valid: boolean;
  error?: string;
} {
  const num = parseFloat(amount);

  if (isNaN(num)) {
    return { valid: false, error: 'Amount must be a valid number' };
  }

  if (num <= 0) {
    return { valid: false, error: 'Amount must be greater than 0' };
  }

  // Check decimal places
  const decimalIndex = amount.indexOf('.');
  if (decimalIndex !== -1) {
    const decimals = amount.substring(decimalIndex + 1);
    if (decimals.length > 4) {
      return {
        valid: false,
        error: 'Amount can have at most 4 decimal places',
      };
    }
  }

  return { valid: true };
}
